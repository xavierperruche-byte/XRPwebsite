---
// src/layouts/ArticleLayout.astro
// This layout wraps your .md files
import Layout from './Layout.astro';
import Carousel from '../components/Carousel.astro';

const { frontmatter } = Astro.props;
const { title, mainImage, mainImageAlt, tags, carouselImages, publishDate } = frontmatter;
---

<Layout title={title}>
  <main class="article-page">
    <article class="article-container">
      <!-- Main Image -->
      <div class="article-hero">
        <img src={mainImage} alt={mainImageAlt} class="article-main-image" />
      </div>

      <!-- Article Header -->
      <header class="article-header">
        <h1 class="article-title">{title}</h1>
        {publishDate && (
          <time class="article-date" datetime={publishDate}>
            {new Date(publishDate).toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            })}
          </time>
        )}
        
        <!-- Tags -->
        <div class="article-tags">
          {tags.map(tag => (
            <a href={`/tags/${tag.toLowerCase().replace(/\s+/g, '-')}`} class="tag">
              {tag}
            </a>
          ))}
        </div>
      </header>

      <!-- Article Content (your markdown renders here) -->
      <div class="article-content">
        <slot />
      </div>

      <!-- Carousel -->
      {carouselImages && carouselImages.length > 0 && (
        <section class="article-carousel">
          <Carousel images={carouselImages} />
        </section>
      )}
    </article>
  </main>

</Layout>

<style>
  .article-page {
    max-width: 80vw;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  .article-container {
    margin: 150px 10px;
    overflow: hidden;
  }

  .article-hero {
    
    width: 100%;
    /* Règle 1: Définir le ratio Hauteur/Largeur. 60% de la largeur signifie un ratio de 100 / 60 = 1.6667 */
    /* Pour un ratio plus simple de 16:9 (env. 56.25% de hauteur), on utiliserait 16 / 9. */
    /* En utilisant l'aspect-ratio CSS moderne : */
    aspect-ratio: 100 / 80; 
    max-height: 800px; 
    display: flex; 
    justify-content: center;
    align-items: center; 
  }

  .article-main-image {
    max-height: 100%;
    max-width: 100%;
    object-fit: contain;
    border-radius: 20px !important;
    display: block;
  }

  .article-header {
    padding: 2rem;
    border-bottom: 1px solid #e5e5e5;
  }

  .article-title {
    font-size: 2.5rem;
    margin: 0 0 1rem 0;
    color: #1a1a1a;
  }

  .article-date {
    display: block;
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 1rem;
  }

  .article-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 1rem;
  }

  .tag {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    background: #f0f0f0;
    color: #333;
    text-decoration: none;
    border-radius: 20px;
    font-size: 0.85rem;
    transition: background 0.2s;
  }

  .tag:hover {
    background: #e0e0e0;
  }

  .article-content {
    padding: 2rem;
    line-height: 1.8;
    color: #333;
  }

  /* Markdown content styling */
  .article-content :global(h1) {
    font-size: 2rem;
    margin: 2rem 0 1rem;
    color: #1a1a1a;
  }

  .article-content :global(h2) {
    font-size: 1.75rem;
    margin: 1.75rem 0 1rem;
    color: #1a1a1a;
  }

  .article-content :global(h3) {
    font-size: 1.5rem;
    margin: 1.5rem 0 0.75rem;
    color: #1a1a1a;
  }

  .article-content :global(p) {
    margin: 1rem 0;
  }

  .article-content :global(ul),
  .article-content :global(ol) {
    margin: 1rem 0;
    padding-left: 2rem;
  }

  .article-content :global(li) {
    margin: 0.5rem 0;
  }

  .article-content :global(code) {
    background: #f5f5f5;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    font-family: 'Courier New', monospace;
    font-size: 0.9em;
  }

  .article-content :global(pre) {
    background: #1e1e1e;
    color: #d4d4d4;
    padding: 1rem;
    border-radius: 5px;
    overflow-x: auto;
    margin: 1.5rem 0;
  }

  .article-content :global(pre code) {
    background: none;
    padding: 0;
    color: inherit;
  }

  .article-content :global(a) {
    color: #0066cc;
    text-decoration: none;
  }

  .article-content :global(a:hover) {
    text-decoration: underline;
  }

  .article-content :global(img) {
    max-width: 100%;
    height: auto;
    border-radius: 5px;
    margin: 1.5rem 0;
  }

  .article-content :global(blockquote) {
    border-left: 4px solid #0066cc;
    padding-left: 1rem;
    margin: 1.5rem 0;
    color: #666;
    font-style: italic;
  }

  .article-carousel {
    padding: 2rem;
    border-top: 1px solid #e5e5e5;
  }

  .article-carousel h2 {
    margin-top: 0;
    margin-bottom: 1.5rem;
  }

  @media (max-width: 768px) {
    .article-title {
      font-size: 1.8rem;
    }

    .article-header,
    .article-content,
    .article-carousel {
      padding: 1.5rem;
    }

    .article-content :global(h1) {
      font-size: 1.5rem;
    }

    .article-content :global(h2) {
      font-size: 1.3rem;
    }

    .article-content :global(h3) {
      font-size: 1.1rem;
    }

  }
</style>